/*! For license information please see 208.f88d7255003ea0cdfc33.js.LICENSE.txt */
"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[208],{78805:(e,t,s)=>{s.d(t,{I:()=>a});var n=s(13821);class a extends n.qL{constructor(e){super(n.R3,`/user/${e}/subscription`)}getRequestData(){}static parseResponse(e){return{subscriptionPayors:e.subscriptionPayors.map((e=>({ownerEmail:e.ownerEmail,currentPeriodEnd:e.currentPeriodEnd?new Date(e.currentPeriodEnd):void 0}))),plansIOwn:e.activePlans.map((e=>{var t;return Object.assign(Object.assign({},e),{members:(null===(t=e.members)||void 0===t?void 0:t.map((e=>Object.assign(Object.assign({},e),{membershipEndDate:e.membershipEndDate?new Date(e.membershipEndDate):void 0}))))||[],startDate:e.startDate?new Date(e.startDate):void 0,currentEndDate:e.currentEndDate?new Date(e.currentEndDate):void 0})})),paymentMethods:e.paymentMethods,billingAddress:e.billingAddress}}}},95208:(e,t,s)=>{s.d(t,{j2:()=>P,VA:()=>D,mU:()=>he});var n=s(2262),a=s(66252);function i(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)e[n]=s[n]}return e}const l=function e(t,s){function n(e,n,a){if("undefined"!=typeof document){"number"==typeof(a=i({},s,a)).expires&&(a.expires=new Date(Date.now()+864e5*a.expires)),a.expires&&(a.expires=a.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var l="";for(var o in a)a[o]&&(l+="; "+o,!0!==a[o]&&(l+="="+a[o].split(";")[0]));return document.cookie=e+"="+t.write(n,e)+l}}return Object.create({set:n,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var s=document.cookie?document.cookie.split("; "):[],n={},a=0;a<s.length;a++){var i=s[a].split("="),l=i.slice(1).join("=");try{var o=decodeURIComponent(i[0]);if(n[o]=t.read(l,o),e===o)break}catch(e){}}return e?n[e]:n}},remove:function(e,t){n(e,"",i({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,i({},this.attributes,t))},withConverter:function(t){return e(i({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(s)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});var o=s(70082),r=s(2465),d=s(29492),u=s(68952),c=s(13821);class p extends c.qL{constructor(e,t,s,n,a,i,l,o,r){super(c.qg,`/user/${e}/subscription`),this.subscriptionId=t,this.defaultPaymentMethodId=s,this.newPlanMembers=n,this.deletedPlanMembers=a,this.unchangedPlanMembers=i,this.monthlyCost=l,this.deletedPaymentMethodIds=o,this.billingAddress=r}getRequestData(){return{subscriptionId:this.subscriptionId,defaultPaymentMethodId:this.defaultPaymentMethodId,newPlanMembers:this.newPlanMembers,deletedPlanMembers:this.deletedPlanMembers,unchangedPlanMembers:this.unchangedPlanMembers,monthlyCost:this.monthlyCost,deletedPaymentMethodIds:this.deletedPaymentMethodIds,billingAddress:this.billingAddress}}}var m=s(78805);class v extends c.qL{constructor(e,t,s){super(c.qg,`/user/${e}/subscription/cancel`),this.subscriptionId=t,this.cancel=s}getRequestData(){return{subscriptionId:this.subscriptionId,cancel:this.cancel}}}class b extends c.qL{constructor(e,t,s){super(c.qg,`/user/${e}/subscription/preview`),this.planMemberCount=t,this.address=s}getRequestData(){return{planMemberCount:this.planMemberCount,address:this.address}}static parseResponse(e){return{currency:e.invoice.currency,subtotal:e.invoice.subtotal,tax:e.invoice.tax||0,total:e.invoice.total,taxRate:e.invoice.taxRate||0}}}var h=s(52433);class y extends c.qL{constructor(e){super(c.R3,`/stripe-pay-method/${e}`)}getRequestData(){}static parseResponse(e){return{id:e.id}}}class f extends c.qL{constructor(e){super(c.R3,`/user/${e}/pay-methods`)}getRequestData(){}static parseResponse(e){return e.paymentMethods}}var g=s(5067);function M(e,t){for(let s of Object.keys(t))e[s]=t[s]}let w,I,x;function P(){let e=(0,u.F)();w=e.userData(),D({subscriptionPayors:[],plansIOwn:[],paymentMethods:[],billingAddress:{line1:"",line2:"",city:"",state:"",postal_code:"",country:""}})}function D(e){x?(x.subscriptionPayors.splice(0,x.subscriptionPayors.length,...e.subscriptionPayors),x.plansIOwn.splice(0,x.plansIOwn.length,...e.plansIOwn),x.paymentMethods.splice(0,x.paymentMethods.length,...e.paymentMethods),M(x.billingAddress,e.billingAddress)):x=(0,n.qj)({subscriptionPayors:e.subscriptionPayors,plansIOwn:e.plansIOwn,paymentMethods:e.paymentMethods,billingAddress:e.billingAddress});const{subscriptionPayors:t,plansIOwn:s,paymentMethods:a,billingAddress:i}=m.I.parseResponse(JSON.parse(JSON.stringify({subscriptionPayors:e.subscriptionPayors,activePlans:e.plansIOwn,paymentMethods:e.paymentMethods,billingAddress:e.billingAddress})));I?(I.subscriptionPayors.splice(0,I.subscriptionPayors.length,...t),I.plansIOwn.splice(0,I.plansIOwn.length,...s),I.paymentMethods.splice(0,I.paymentMethods.length,...a),M(I.billingAddress,i)):I=(0,n.qj)({subscriptionPayors:t,plansIOwn:s,paymentMethods:a,billingAddress:i})}const A="subscriptionData";function C(){let e={subscriptionId:R.value,deletedPlanMembers:V.value,newPlanMembers:$.value,deletedPaymentMethodIds:te.value.map((e=>e.cardId)),billingAddress:x.billingAddress};l.set(A,JSON.stringify(e),{sameSite:"Strict"})}function E(){let e=l.get(A);if(e){l.remove(A,{sameSite:"Strict"});let t=JSON.parse(e);return t.subscriptionId&&(t.subscriptionId===O?N():t.subscriptionId!==R.value&&F(t.subscriptionId)),t.newPlanMembers&&t.newPlanMembers.length>0&&t.newPlanMembers.forEach((e=>{Z(e.email)})),t.deletedPlanMembers&&t.deletedPlanMembers.length>0&&t.deletedPlanMembers.forEach((e=>{_(e.email)})),t.deletedPaymentMethodIds&&t.deletedPaymentMethodIds.length>0&&t.deletedPaymentMethodIds.forEach((e=>{W(e)})),(0,h.wy)(t.billingAddress,x.billingAddress)||Object.keys(t.billingAddress).forEach((e=>{x.billingAddress[e]=t.billingAddress[e]})),!0}return!1}const T=(0,a.Fl)((()=>I.subscriptionPayors)),S=(0,a.Fl)((()=>T.value.filter((e=>!e.currentPeriodEnd)))),O="new",R=(0,n.iH)(void 0);function N(){x.plansIOwn.some((e=>e.subscriptionId===O))||x.plansIOwn.push({subscriptionId:O,planName:"Friends and Family",members:[],startDate:new Date,currentEndDate:new Date,cancelAtPeriodEnd:!1,paymentMethodId:void 0,currentMonthlyCost:0}),F(O)}function F(e){R.value=e}function q(e,t=(()=>{})){new v(w.value.userId,e,!0).send((({data:e})=>{0===e.statusCode?((0,o.useVueNotify)().showNotification({cssClasses:["mw-notification-success"],dismissAfterMillis:4e3,data:{message:"Your plan has been cancelled."}}),t()):r.x("1.5.16",[e.errorMessage])}))}function k(e,t=(()=>{})){new v(w.value.userId,e,!1).send((({data:e})=>{0===e.statusCode?((0,o.useVueNotify)().showNotification({cssClasses:["mw-notification-success"],dismissAfterMillis:4e3,data:{message:"Your plan has been resumed!"}}),t()):r.x("1.5.18",[e.errorMessage])}))}const U=(0,a.Fl)((()=>x.plansIOwn.find((e=>e.subscriptionId===R.value)))),j=(0,a.Fl)((()=>I.plansIOwn.find((e=>e.subscriptionId===R.value)))),Y=(0,a.Fl)((()=>I.plansIOwn.map((e=>({subscriptionId:e.subscriptionId,planName:e.planName,activeMembers:(e.members||[]).filter((e=>!e.membershipEndDate)).map((e=>e.email)).sort(),currentMonthlyCost:e.currentMonthlyCost,startDate:e.startDate,cancelAtPeriodEnd:e.cancelAtPeriodEnd,currentEndDate:e.currentEndDate,paymentMethod:I.paymentMethods.find((t=>t.cardId===e.paymentMethodId)),pastDue:!e.cancelAtPeriodEnd&&e.currentEndDate<new Date})))));function L(e){U.value&&(U.value.currentMonthlyCost=e)}const $=(0,a.Fl)((()=>{var e,t,s;return null===(s=null===(t=null===(e=U.value)||void 0===e?void 0:e.members)||void 0===t?void 0:t.filter((e=>!e.membershipEndDate)))||void 0===s?void 0:s.filter((e=>{var t,s;return!(null===(s=null===(t=j.value)||void 0===t?void 0:t.members)||void 0===s?void 0:s.some((t=>t.email===e.email&&!t.membershipEndDate)))}))})),V=(0,a.Fl)((()=>{var e,t,s;return null===(s=null===(t=null===(e=U.value)||void 0===e?void 0:e.members)||void 0===t?void 0:t.filter((e=>e.membershipEndDate)))||void 0===s?void 0:s.filter((e=>{var t,s;return null===(s=null===(t=j.value)||void 0===t?void 0:t.members)||void 0===s?void 0:s.some((t=>t.email===e.email&&!t.membershipEndDate))}))})),B=(0,a.Fl)((()=>{var e,t,s;return null===(s=null===(t=null===(e=U.value)||void 0===e?void 0:e.members)||void 0===t?void 0:t.filter((e=>!e.membershipEndDate)))||void 0===s?void 0:s.filter((e=>{var t,s;return null===(s=null===(t=j.value)||void 0===t?void 0:t.members)||void 0===s?void 0:s.some((t=>t.email===e.email&&!t.membershipEndDate))}))})),H=[{index:0,billable:!1,buttonText:"Activate",statusCSS:"red",statusText:"Inactive",statusTooltipText:"You are on a free plan. Activate for an additional $2.50/month to get paid features."},{index:1,billable:!0,buttonText:"Deactivate",statusCSS:"yellow",statusText:"Adding",statusTooltipText:"Once you save, your user will be on a paid plan."},{index:2,billable:!0,buttonText:"Deactivate",statusCSS:"green",statusText:"Active",statusTooltipText:"You are on a paid plan. Deactivating will put your user on a free plan, but will not impact other users on your plan."},{index:3,billable:!1,buttonText:"Activate",statusCSS:"yellow",statusText:"Removing",statusTooltipText:"Once you save, your user will be downgraded to a free plan. The other users on your plan will not be impacted."},{index:4,billable:!1,buttonText:"Reactivate",statusCSS:"red",statusText:"Expires soon",statusTooltipText:"At the end of your billing cycle, your user will lose all paid benefits."},{index:5,billable:!0,buttonText:"Deactivate",statusCSS:"yellow",statusText:"Adding",statusTooltipText:"Once you save, your user will be back on your paid plan."}],J=[{index:0,billable:!0,buttonText:"Remove",statusCSS:"yellow",statusText:"Adding",statusTooltipText:"User will be added to your paid plan. You'll start being charged for them at your next billing cycle."},{index:1,billable:!0,buttonText:"Deactivate",statusCSS:"green",statusText:"Active",statusTooltipText:"User is part of your paid plan."},{index:2,billable:!1,buttonText:"Reactivate",statusCSS:"yellow",statusText:"Removing",statusTooltipText:"After saving changes, user's subscription will end and you will no longer be charged for them."},{index:3,billable:!1,buttonText:"Reactivate",statusCSS:"red",statusText:"Expires soon",statusTooltipText:"User has been removed from your plan."},{index:4,billable:!0,buttonText:"Deactivate",statusCSS:"yellow",statusText:"Adding",statusTooltipText:"User will be added back to your paid plan."}],z=(0,a.Fl)((()=>{var e,t,s;if(!U.value)return[];let n=[],a=U.value.members.find((e=>e.email===w.value.email)),i=null===(e=j.value)||void 0===e?void 0:e.members.find((e=>e.email===w.value.email)),l={email:w.value.email};const o=null!==(t=!(null==i?void 0:i.membershipEndDate))&&void 0!==t&&t,d=null!==(s=!(null==a?void 0:a.membershipEndDate))&&void 0!==s&&s;return i||a?!i&&d?l.subscriptionState=H[1]:o&&d?l.subscriptionState=H[2]:o&&!d?l.subscriptionState=H[3]:o||d?!o&&d?l.subscriptionState=H[5]:r.x("1.5.10"):l.subscriptionState=H[4]:l.subscriptionState=H[0],n.push(l),U.value.members.filter((e=>e.email!==w.value.email)).forEach((e=>{var t,s,a;let i=null===(t=j.value)||void 0===t?void 0:t.members.find((t=>t.email===e.email)),l={email:e.email};const o=null!==(s=!(null==i?void 0:i.membershipEndDate))&&void 0!==s&&s,d=null!==(a=!(null==e?void 0:e.membershipEndDate))&&void 0!==a&&a;!i&&d?l.subscriptionState=J[0]:o&&d?l.subscriptionState=J[1]:o&&!d?l.subscriptionState=J[2]:o||d?!o&&d?l.subscriptionState=J[4]:r.x("1.5.11"):l.subscriptionState=J[3],n.push(l)})),n})),G=(0,a.Fl)((()=>z.value.filter((e=>{var t;return null===(t=e.subscriptionState)||void 0===t?void 0:t.billable}))));function _(e){var t;if(!U.value)return;let s=null===(t=j.value)||void 0===t?void 0:t.members.find((t=>t.email===e)),n=U.value.members.findIndex((t=>t.email===e));-1!==n?s?U.value.members[n].membershipEndDate=s.membershipEndDate||U.value.currentEndDate:U.value.members.splice(n,1):r.x("1.5.12")}function Z(e){if(!R.value||!U.value)return;let t=U.value.members.find((t=>t.email===e));t?t.membershipEndDate=void 0:U.value.members.push({subscriptionId:R.value,email:e,membershipEndDate:void 0})}function K(){let e=[];return G.value.length>8?e.push("Your plan is limited to only eight members."):0===G.value.length&&e.push("You must have at least one plan member to set up a paid plan."),!me(e)}function Q(e){U.value&&(U.value.paymentMethodId=e)}function W(e){let t=x.paymentMethods.findIndex((t=>t.cardId===e));x.paymentMethods.splice(t,1),U.value&&U.value.paymentMethodId===e&&Q(void 0)}const X=(0,a.Fl)((()=>x.paymentMethods)),ee=(0,a.Fl)((()=>{var e;return null===(e=U.value)||void 0===e?void 0:e.paymentMethodId})),te=(0,a.Fl)((()=>I.paymentMethods.filter((e=>!x.paymentMethods.some((t=>t.cardId===e.cardId))))));function se(){let e=[];const t=x.paymentMethods.find((e=>e.cardId===U.value.paymentMethodId)),s=new Date,n=(0,d.lG)(s.getUTCFullYear(),s.getUTCMonth());return t?(0,d.lG)(t.expYear,t.expMonth)<n&&e.push("Your selected payment method is expired."):e.push("Please add a valid payment method before continuing."),!me(e)}const ne=(0,n.iH)(void 0);function ae(e){U.value&&new y(e).send((({data:e})=>{const t=y.parseResponse(e).id;(0,g.$)((()=>new Promise(((e,s)=>{new f(w.value.userId).send((({data:s})=>{if(0===s.statusCode){const n=f.parseResponse(s);n.some((e=>e.cardId===t))?(n.forEach((e=>{x.paymentMethods.some((t=>t.cardId===e.cardId))||I.paymentMethods.some((t=>t.cardId===e.cardId))||x.paymentMethods.push(e)})),e(!0)):e(!1)}else e(!0),r.x("1.5.22",[s.errorMessage])}))}))),(()=>{Q(t),ne.value=t}),(()=>{r.x("1.5.23")}))}))}const ie=/^\d{5}(-\d{4})?$/;function le(){var e,t,s,n;let a=[];return(0,d.fp)((null===(e=null==x?void 0:x.billingAddress)||void 0===e?void 0:e.line1)||"")&&a.push("Address Line 1 must have a valid street address."),(0,d.fp)((null===(t=null==x?void 0:x.billingAddress)||void 0===t?void 0:t.city)||"")&&a.push("You must enter a valid city."),ie.test((null===(s=null==x?void 0:x.billingAddress)||void 0===s?void 0:s.postal_code)||"")||a.push("Zip code is not a valid format."),(0,d.fp)((null===(n=null==x?void 0:x.billingAddress)||void 0===n?void 0:n.state)||"")&&a.push("You must select a valid state."),!me(a)}const oe=(0,a.Fl)((()=>{var e,t,s;return{isNewPlan:(null===(e=U.value)||void 0===e?void 0:e.subscriptionId)===O,nextBillDate:null===(t=U.value)||void 0===t?void 0:t.currentEndDate,billableMemberCount:G.value.length,ccLastFour:null===(s=X.value.find((e=>e.cardId===ee.value)))||void 0===s?void 0:s.lastFour}})),re=(0,n.iH)({currency:"usd",subtotal:0,tax:0,total:0,taxRate:0});function de(e=(()=>{}),t=(()=>{})){new b(w.value.userId,G.value.length,x.billingAddress).send((({data:s})=>{0===s.statusCode?(re.value=b.parseResponse(s),e()):(r.x("1.5.21",[s.errorMessage]),t())}))}const ue=(0,a.Fl)((()=>{var e,t,s;return!!($.value&&V.value&&U.value)&&((null===(e=$.value)||void 0===e?void 0:e.length)>0||(null===(t=V.value)||void 0===t?void 0:t.length)>0||te.value.length>0||U.value.paymentMethodId!==(null===(s=j.value)||void 0===s?void 0:s.paymentMethodId)||!(0,h.wy)(x.billingAddress,I.billingAddress))}));let ce;function pe(){ce&&((0,o.useVueNotify)().deleteNotification(ce),ce=void 0)}function me(e){return pe(),1===e.length?ce=(0,o.useVueNotify)().showNotification({cssClasses:["mw-notification-failure"],data:{message:e[0]}}):e.length>1&&(ce=(0,o.useVueNotify)().showNotification({componentName:"mw-vn-message-with-list",cssClasses:["mw-notification-failure"],data:{items:e}})),0!==e.length}let ve=(0,n.iH)(!1);function be(e=(()=>{}),t=(()=>{})){var s;if(ue.value){let n=w.value.userId;n?(ve.value=!0,new p(n,U.value.subscriptionId===O?void 0:U.value.subscriptionId,null===(s=U.value)||void 0===s?void 0:s.paymentMethodId,$.value,V.value,B.value,re.value.total,te.value.map((e=>e.cardId)),x.billingAddress).send((({data:s})=>{ve.value=!1,0===s.statusCode?(e(),(0,o.useVueNotify)().showNotification({cssClasses:["mw-notification-success"],dismissAfterMillis:4e3,data:{message:"Subscription updated successfully!"}})):(t(),r.x("1.5.9",[s.errorMessage]))}))):r.x("1.5.8")}else e(),(0,o.useVueNotify)().showNotification({cssClasses:["mw-notification-warning"],dismissAfterMillis:4e3,data:{message:"No changes were made."}})}function he(){return{saveChangesToCookie:C,tryLoadDataFromCookie:E,allSubscriptionPayors:T,activeSubscriptionPayors:S,subscriptionIdBeingEdited:R,createNewPlan:N,editPlan:F,cancelPlan:q,resumePlan:k,planSummaries:Y,setMonthlyCost:L,newPlanMembers:$,deletedPlanMembers:V,unchangedPlanMembers:B,displayedPlanMembers:z,billableDisplayedPlanMembers:G,removePlanMember:_,addPlanMember:Z,validatePlanMembers:K,setDefaultPaymentMethod:Q,deletePaymentMethod:W,paymentMethods:X,currentPaymentMethodId:ee,validatePaymentMethod:se,recentlyAddedPaymentMethodId:ne,selectRecentlyAddedPaymentMethod:ae,billingAddress:(0,n.iH)(x.billingAddress),validateAddress:le,billingInfo:oe,previewInvoice:re,generatePreviewInvoice:de,clearErrorNotification:pe,displayErrors:me,saveData:be}}}}]);